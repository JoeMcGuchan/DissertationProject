\documentclass[12pt]{article}
\usepackage{hyperref}
\usepackage{gensymb}
\usepackage{imakeidx}
\makeindex

\begin{document}
\title{Modelling Low Earth Orbit Constellations for Networking}
\author{Joseph McGuchan}
\maketitle
\thispagestyle{empty}

%TODO Cover Sheet

\newpage

%TODO Declaration of Originality

I, Joseph Law McGuchan of King's College, being a candidate for Part II of the Computer Science Tripos, hereby declare that this dissertation and the work described in it are my own work, unaided except as may be specified below, and that the dissertation does not contain material that has already been used to any substantial extent for a comparable purpose.

Signed %TODO

Date %TODO

\newpage

%TODO Proforma

%Your candidate number.
%The Title of your Project. 
Modelling Low Earth Orbit Constellations for Networking
%The Examination and Year.
%Word-count for the dissertation.
%Final line count: Number of lines written by the *student* in the final version of their %software work.
%Project Originator.
%Project Supervisor.
%At most 100 words describing the original aims of the project.
%At most 100 words summarising the work completed.
%At most 100 words describing any special difficulties that you faced. 
%(In most cases the special difficulties entry will say “None”.)

\newpage

\tableofcontents

\section{Introduction}

SpaceX are planning to launch a constellation of 4,425 low Earth orbit communication satellites in the next few years. The objective of this constellation, called Starlink, is to provide low-latency internet connection across the world.

The satellites in this network will be in constant motion, not just relative to the ground, but relative to one another, creating a network with a constantly changing topology and associated latencies. The question of how to structure such a network, and what the resultant latencies of said network will be, has not been thoroughly explored, but it will become increasingly relevant as more and more companies build similar constellations. If these Constellations prove to provide significant gains in latency while providing competetive bandwidth, they might render previous submarine optical cables obsolete.

My goals are:
\begin{enumerate}
	\item To create visualisations of the SpaceX conselation.
	\item To experiment with different topologies of the SpaceX network and test their associated latencies. 
\end{enumerate}

\subsection{What is Starlink?}

The purpouse of Starlink is to provide low latency internet connections, as of 21/11/18, there are two companies offering sattelite internet services, Excede\cite{ExcedeWebsite}, and Hughes, whose 9202 BGAN Land Portable Satellite Terminal offers connection speeds up to 464kbps\cite{HughesWebsite}. These companies largely target domestic use in rural areas which don’t have a faster coverage, and corporations, providing internet connections to airplanes and cargo ships. Currently, Sattelite Internet connection is a last resort, something turned to when conventional means of connection are not available, Starlink intends to invert this, turning sattelite internet into the premium option. 

The difference between Starlink and currently existing brands is that current brands use geostationary sattelites \cite{HughesPressRelease}, while Starlink will use LEO satellites. The significantly shorter distance will create muchshorter paths for singnals. On top of this, SpaceX will be utilising laser communication between satellites, as opposed to the competetiors who have little to no intra-satellite communication. In the vaccum of space, lights travels 47\% faster than in glass \cite{PropertiesOfGlass}. Therefore, in theory, a LEO network utilising lasers whould achieve latencies far lower than that by even the best terrestrial fiberoptic connections over long distances.

\subsection{Why Focus on Starlink?}

Starlink is only one of a number of different LEO internet networks that have been proposed, so why should I focus on it's topology? Ideally, I would like the conclusions of my study to be generalisable to many other LEO consellations. However, constellations are approved by the FCC on a case-by-case basis, using a complicated and changing system of legislations, it's not easy to know what a normal network looks like. By analysing the properties of a network of my own design, I run a much greater risk of coming to conclusions that cannot be generalised, as I am not working on an FCC-approved constellation.

What about the constellations of other companies? %TODO WHEN GOVERNMENT FUNDING RETURNS

By analysing the properties of Starlink, we are analysing a network that is confirmed legally and scientifically plausible.

But there is another reason to investigate Starlink. As the largest of most high-profile attempts to build a LEO internet backbone, Starlink represents themost significant competitor to other emerging sattelite communications networks and the one more likely to become dominant in future years. By theorising about it's properties now, we can prepare ourselves for the changes Starlink might pose to communications in the upcoming years.

\subsection{Why Create a Visualisation?}
When it comes to understanding a network such as starlink, a visual description is incredibly valuable. By visualising the network we can develop an intuition for how it operates, and use that intuition to develop ideas for new algoritms and structures for testing.

Creating a visualisation also poses a minimal additional cost on my part, as to accurately model the latencies between base stations I will need to simulate satellite positions and links anyway.

\subsection{Mark Handley's Work}

%TODO

My initial proposal for the project was inspired by the findings of an existing study done  by Mark Handley, since proposing the project, Mark Handley has made his results publicly available\cite{OriginalReport}, so my new goal will be to replicate and expand upon his findings.

\subsection{What I Will Be Using}
To create the visualisation I will be using the open-source game engine Godot. Using a game engine struck me as the simplest way to create a visualisation tool, and Godot, being powerful, open-source, and capable of runningeasily on many devices, seemed like the ideal choice.

For the parts of code related to visualisation I will be using godots build in script GDScript, which is easy to use and specifically designed to intergrate well with the godot engine. For parts of the code related to simulation I will use C\#, which godot is compatable with, and which offers significance performance improvements over gdscript.

\section{Preparation}

%TODO



\subsection{Starting Point}

Most of the information I will be using for the structure of the SpaceX network comes from their application to the FCC on March 29th, 2018\cite{FCCApplication}, and their technical attachment\cite{TechnicalAttachment}, which outlines the various orbital spheres, planes within each sphere, and various other details of the constellation. I will also be building on insights gleaned from Handley's original research.



%TODO

SpaceX have already sent up two test sattelites, and according the Elon Musk, they are working very well, providing a latency of only 25ms\cite{ElonMuskTweet}.

%TODO

\subsection{The Properties of Orbits}

	%TODO DRAW A DIAGRAM

\subsection{The Structure of Starlink}

There is a lot we do not know about Starlink, but this is what we can infer from SpaceX’s application to the FCC\cite{FCCApplication}, 

Starlink is a constellation of 4,425 LEO sattelites with a further proposed. %TODO when govern funding back
We will be examining only the 4,425 sattelites proposed for the first implemantation of Starlink, as these intend to provide a viable network by temselves, and additional sattelites might overwhelm my visualisation techniques. 

\begin{figure}
\label{fig:Starlink Orbits}
\caption{The layout of Starlink}
\begin{tabular}{|c|c|c|c|c|c|}
\hline
\multicolumn{6}{|c|}{SPACEX SYSTEM CONSTELLATION} \\
\hline
Parameter & Initial Deployment & \multicolumn{4}{|c|}{Final Deployment} \\
& (1,600 satellites) & \multicolumn{4}{|c|}{(2,825 satellites)} \\
\hline
Orbital Planes & 32 & 32 & 8 & 5 & 6 \\
Sattelites per Plane & 50 & 50 & 50 & 75 & 75 \\
Altitude & 1150km & 1110km & 1130km & 1275km & 1325km \\
Inclination & 53\degree & 53.8\degree & 74\degree & 80\degree & 70\degree \\
\hline
\end{tabular}
\end{figure}

In it's application to the FCC SpaceX was required to state any notable debris that might not burn up if a sattelite were to descend from orbit. Amoung the components listed where 5 silicon carbide “communication components”, silicon carbide is used in mirrors for laser communication links, and we can therefore conclude that SpaceX's satellites will have, at most, 5 avilable links to form with nearby sattelites.

We also know information about how Starlink sattelites will communicate with ground stations, a base station may only connect with a sattelite at an inclination less than 40\degree from the vertical using Radio Frequency (not laser) connections. Connections will be stronger to sattelites directly overhead, however as Starlink does not provide much information in exactly how their intra-satellite communications work, speculations on bandwidth will not prove to be helpful.

\subsection{Modelling Sattelites in Orbit}

Typically, an orbit around the surface of the earth is described by:

\begin{description}
\item[Distance Above the Surface]
\item[Inclination]
This is the angle between the orbital plane, and the equatorial plane, (the plane on which the equator lies).
\item[Longditudonal Offset]
If inclination is greater than 0\degree, then the orbital plane and equatorial plane will intersect at a line, the angle between this line and the plane described by the great circle at longditute 0\degree is the longditudonal offset. In other words, the Longditudonal offset is the Londitudute of the point where this line passes through the surface of the earth.
\item[Eccentricity]
The eccentricity coefficient describes the “squashness” of the orbit. For the time being, we will be ignoring this...
\item[Retrograde]
A retrograde orbit is one that goes against the rotation of the earth, typically these are described by orbits with a longditudonal offset greater than 180\degree. It is significantly more expensive to put a sattelite into a retrograte orbit, and is essentially never done.
\end{description}

Furthermore, an individual satellite's position in an orbit can be described by:

\begin{description}
\item[True Anomaly]
The angle between the line drawn from the origin to the satellite, and the line drawn from the origin to the point on the sattelite's orbit of longditude 0.
\item[Phase Offset]
This is the satellite's true anomaly at time 0.
\end{description}

In our model, true anomaly is the only variable that changes. The way it changes is uniquely determined by the other 6 variables. The rate of change of true anomaly, the anglular velocity, is given by

\[\sqrt{\frac{GM}{r^3}}\]

Where r is the distance from the origin, or altitude + radius of the Earth.

Note that while altitude is constant (eccentricity = 0) velocity is unchanging, and true anomaly can be described as a linear function of time.

The position of a sattelite is calculated by taking it’s true anomaly and adding it’s angular velocity multiplied by the timestep (real timesince last frame update * some factor). The location is then calculated through a series of transformations performed on the true anomaly:

\begin{enumerate}
\item We take a vector (r, 0, 0) where r is the distance above the surface + the radius of Earth.
\item We rotate this point around (0, 1, 0) (the line through the poles) by the true anomaly.
\item We rotate this point around (1, 0, 0) (the line from 0 longditude to 180 longditude through the equator) by the inclination.
\item We rotate this point around (0, 1, 0) agian by the longditudonal offset.
\end{enumerate}

Because the only variable that is changed is the true anomaly, and the x, y, and z coordinates are determined by only this variable and a series of fixed variables, we do not run thesame risks normal discete physics models face when describing continuous behaviour, such as unredictable behaviour when sped up, at extreme forces, or the steady moving of orbits.

For the rest of this document, a sattelite will be denoted by $x_{i,j,k}$. Where i demotes the orbital sphere, $s_i$, and $j$ denotes the orbital plane $o_{i,j}$. $n_i$ will be used to denote the number of satellites per plane of obital sphere $s_i$ (50 or 75).

\subsection{Variables}
While we can learn a lot from SpaceX's applications, there are still a number of variables that are left undetermined. 

\begin{description}
\item[Distribution on Orbit]
SpaceX only specifies which orbital planes it requires, and how many satellites will be on each plane, it does not specify where sattelites will be positioned on those planes. This leads us to speculate as to how sattelites will be distributed. I will describe the distribution of $o_{i,j}$ by the normalised $n_i$-dimensional vector $d_i$, where $(2\pi d_i)_k$ gives the arc between $x_{i,j,k}$ and $x_{i,j,k+1}$. For simplicitys sake, I will use non-normalised vectors as shorthand for normalised vectors, and vectors that are too short as shorthand for repeatind patterns. For instance:

\[d_i = [1]\] 

Is shorthand for:

\[d_i = \frac{1}{n_i}[1,1,...,1]\] 

And:

\[d_i = [1,3]\] 

Is shorthand for:

\[d_i = \frac{1}{n_i}[0.5,1.5,0.5,1.5,...]\]

	
\item[Phase Offset]
As we do not know for certain how satellites will be positioned in orbits, we also do not know how they will be positioned relative to other orbits. The phase offset of an obit $o_{i,j}$, $po_{i,j}$, can be described as a number from 0 to 1, where, $\forall k$, 0 indicates that  $x_{i,j,k}$ will cross the equator at the same time as $x_{i,j+1,k}$, and 1 indicates that satellite $x_{i,j,k}$ will cross the equator at the same time as $x_{i,j+1,k+1}$. This number will have to be some fraction of the total number of orbits, to garuntee that the first and last orbits are properly aligned.

Each of the orbital spheres can also be offset from each other. The phase offset of spheres will be described very differently: $ps_i$ will be a 2D vector that decribes the longditude and latitude of $x_{i,0,0}$ when $x_{0,0,0}$ crosses the equator.

\item[Link usage]
Each satellite will have a maximum of 5 links, however, we do not as of yet know which arrangements of links are the most optimal.

In his study Mark Handley uses two links to connect $x_{i,j,k}$ to $x_{i,j,k+1}$ and $x_{i,j,k-1}$. He then uses two more to connect $x_{i,j,k}$ to $x_{i,j+1,k+h_i}$ and $x_{i,j-1,k-h_i}$, where $h_i$ is a variable that describes how "diagonal" these sideways links should be. The final link connects to the nearest unconnected satellite. However there a number of different ways to connect up the sattelites, for a given sphere $s_i$ I will catagorise the different link usage methods as.

\begin{description}
\item[Handley(h)] Mark Handley's method where $h_i = h$.
\item[OneFree(X)] A generalisation of Handley, described by a 2*2 matrix X. Where $x_{i,j,k}$ connects to $x_{i,j+X_{0,0},k+X_{0,1}}$, $x_{i,j+X_{1,0},k+X_{1,1}}$ and visa-versa.
\item[ThreeFreeBasic] In which $x_{i,j,k}$ connects to $x_{i,j,k+1}$ and $x_{i,j,k-1}$, and the other three links connect to nearby satellites.
\item[ThreeFree(v)] A generalisation of ThreeFree, described by a 2d vector v, in which $x_{i,j,k}$ connects to $x_{i,j+v_0,k+v_1}$ and visa versa.
\item[FiveFree] In which all 5 links are free links, connecting dynamically to the closest nodes.
\end{description}

\item[Response to Conjestion]
Very little is known about how much load Starlink expects to receive or how it will respond to congestion. We know that Starlink will be quite a resiliant network, with a great number of alternative parths available with similar latencies, so systems that predict hotspots on the network and route to avoid them might prove quite effective. However the exact benefit of these systems is yet to be examined.
\end{description}

\section{Implementation}

\subsection{Repository Overview}

\subsection{Difficulties of modelling orbits}
On Implementation, I found that my planned method  of implimenting orbits was flawed, being able to simulate only 500 sattelites in motion before slowing down. Because of this, I changed to a precomputed method. In this method, orbits are precomputed as a number of points, and the position of sattelites is calculated by interpolating adgacent points, this sacrifices some accuracy, but castly increases the computation speed.

\section{Evaluation}

\subsection{Analysis of Variables}
For each of these variables, I modeled a variety of different possibilities, examining the latency of connections with each of these.

%TODO

\section{Conclusion}

%TODO

\begin{thebibliography}{99}
	%using the vancouver system https://en.wikipedia.org/wiki/Vancouver_system
	\bibitem{ExedeWebsite} \url{https://www.exede.com}
	\bibitem{HughesWebsite} \url{https://www.hughes.com}
	\bibitem{ElonMuskTweet} \url{https://twitter.com/elonmusk/status/1000453321121923072}
	\bibitem{FCCApplication} \url{licensing.fcc.gov/cgi-bin/ws.exe/prod/ib/forms/reports/related_filing.hts?f_key=-289550&f_number=SATLOA2016111500118}
	\bibitem{TechnicalAttachment} \url{https://licensing.fcc.gov/myibfs/download.do?attachment_key=1158350}
	\bibitem{OriginalReport} \url{http://nrg.cs.ucl.ac.uk/mjh/starlink/}
	\bibitem{StuffInSpace} \url{http://stuffin.space/}
	\bibitem{PropertiesOfGlass} \url{http://ece466.groups.et.byu.net/notes/smf28.pdf}
	\bibitem{HughesPressRelease} \url{https://www.hughes.com/who-we-are/resources/press-releases/hughes-high-throughput-satellite-successfully-launched-setting?locale=en}
	\bibitem{EchoStar} \url{https://space.skyrocket.de/doc_sdat/jupiter-2.htm}
	\bibitem{KABand} \url{file:///home/joe/Downloads/R12-ITURKA.BAND-C-0008!!PDF-E.pdf}
\end{thebibliography}
\appendix

\section{Appendix A}

\printindex

%TODO Project Proposal

\end{document}